# Mesh UV Mask Generator for Unity

Unity エディタ拡張で、選択したメッシュの UV レイアウトからマスクテクスチャを生成するツールです。

## 機能

### 面選択
- シーンビューで直接面をクリックして選択
- 個別メッシュモード: クリックした面のみを選択
- UVアイランドモード: UV空間で接続された面を一括選択
- 細かいメッシュの選択に対応
- 重複するメッシュの場合、手前の面を選択

### マスク生成
- 選択した面のUVマスクテクスチャを生成
- 選択モード時にワイヤーフレーム表示
- テクスチャサイズ、背景色、マスク色、線の太さを設定可能

### プレビューと保存
- 面選択時にプレビューを更新
- PNG形式でアセットとして保存

## インストール

### VPM
1. (https://vpm.32ba.net)[https://vpm.32ba.net]を開く
2. `Add to VCC`でVCCに追加
3. VCCから`Mesh UV Mask Generator`を検索してインストール

### Unity Package Manager
1. Window > Package Manager を開く
2. "+" > "Add package from git URL..." を選択
3. `https://github.com/32ba/mesh-uv-mask-generator.git` を入力

### UnityPackage
1. ReleasesからUnityPackageをダウンロード
2. Unityエディタにドラッグ＆ドロップしてインストール

### 手動インストール
1. リポジトリをクローンまたはダウンロード
2. `Packages/` フォルダに配置するか、`Assets/` にコピー

## 使用方法

### 1. 基本的な使い方

1. **エディタウィンドウを開く**
   - メニューバーから `Window > Mesh UV Mask Generator` を選択

2. **メッシュを選択**
   - Hierarchy ビューで以下のいずれかを選択：
     - MeshFilter コンポーネントを持つ GameObject
     - SkinnedMeshRenderer コンポーネントを持つ GameObject

3. **面を選択**
   - **メッシュ選択**タブでシーンビューの面をクリック
   - 個別メッシュモードまたはUVアイランドモードを選択

4. **マスクを生成・保存**
   - **エクスポート**タブで設定を調整
   - 「Save Texture As...」ボタンでPNG形式で保存

### 2. 面選択の詳細

#### 個別メッシュモード
- クリックした面のみを選択
- 細かい部分の選択に使用

#### UVアイランドモード 
- クリックした面と同じUVアイランドの面を選択
- UV閾値で接続判定を調整（0.0001〜0.01）
- 衣装パーツなどの選択に使用

#### 操作方法
- 左クリック: 面を選択/選択解除
- Shift + クリック: 選択に追加
- Ctrl/Cmd + クリック: 選択から削除

#### 仕様
- 細かいメッシュも選択可能
- 重複するメッシュの場合、手前の面を選択
- 裏面は基本的に選択されない
- BlendShapeで変形したメッシュに対応
- 選択モード時にワイヤーフレーム表示

## 技術仕様

### 対応Unity バージョン
Unity 2022.3 以降

### 対応メッシュ形式
- MeshFilter のメッシュ
- SkinnedMeshRenderer のメッシュ（BlendShape対応）
- マルチマテリアル対応

### 実装
- レイキャストによる面選択
- UV座標の隣接性によるUVアイランド検出
- 法線ベクトルによるバックフェースカリング
- 距離による重複メッシュの選択優先度
- OpenGLによるワイヤーフレーム描画

## 注意事項

- UV座標が 0-1 の範囲外にある場合も描画されます
- 大きなメッシュや高解像度設定では生成に時間がかかる場合があります
- メモリ使用量はテクスチャサイズに比例します（4096x4096 で約64MB）
- 選択モード時はエディタのパフォーマンスが低下する場合があります

## ライセンス

MIT License
